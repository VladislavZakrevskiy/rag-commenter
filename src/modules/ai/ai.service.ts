import { Injectable, Logger } from '@nestjs/common';
import { ConfigService } from '@nestjs/config';
import axios from 'axios';
import { PrismaService } from '../database/prisma.service';
import type { SimilarText, CommentGenerationData } from '../../types';

type YandexCloudEmbeddingResponse = {
  embedding: string[];
  numTokens: string;
  modelVersion: string;
};

type YandexGPTResponse = {
  result: {
    alternatives: {
      message: {
        role: string;
        text: string;
        toolCallList: {
          toolCalls: {
            functionCall: {
              name: string;
              arguments: object;
            };
          }[];
        };
        toolResultList: {
          toolResults: {
            functionResult: {
              name: string;
              content: string;
            };
          }[];
        };
      };
      status: string;
    }[];
    usage: {
      inputTextTokens: string;
      completionTokens: string;
      totalTokens: string;
      completionTokensDetails: {
        reasoningTokens: string;
      };
    };
    modelVersion: string;
  };
};

@Injectable()
export class AiService {
  private readonly logger = new Logger(AiService.name);

  constructor(
    private readonly configService: ConfigService,
    private readonly prisma: PrismaService,
  ) {}

  async createEmbedding(text: string): Promise<number[]> {
    try {
      this.logger.log(
        `Creating real embedding for text: ${text.substring(0, 50)}...`,
      );

      const iamToken = this.configService.get<string>('yandexCloud.apiKey');
      const folderId = this.configService.get<string>('yandexCloud.folderId');

      if (!iamToken || !folderId) {
        throw new Error('Yandex Cloud API key or folder ID is not configured.');
      }

      const url =
        'https://llm.api.cloud.yandex.net/foundationModels/v1/textEmbedding';
      const headers = {
        Authorization: `Bearer ${iamToken}`,
        'Content-Type': 'application/json',
      };
      const body = {
        modelUri: `emb://${folderId}/text-search-doc/latest`,
        text: text,
      };

      const response = await axios.post(url, body, { headers });

      const embedding = response.data as YandexCloudEmbeddingResponse;

      if (!embedding) {
        throw new Error('Yandex Cloud API did not return an embedding.');
      }

      return embedding.embedding.map((item) => parseFloat(item));
    } catch (error) {
      this.logger.error(
        `Failed to create embedding: ${error instanceof Error ? error.message : 'Unknown error'}`,
      );
      return Array(256).fill(0) as number[];
    }
  }

  async findRelevantPosts(
    embedding: number[],
    limit = 10,
  ): Promise<SimilarText[]> {
    try {
      const results = await this.prisma.findSimilarTexts(embedding, limit);
      return results as SimilarText[];
    } catch (error) {
      this.logger.error(
        `Failed to find relevant posts: ${error instanceof Error ? error.message : 'Unknown error'}`,
      );
      return [];
    }
  }

  async generateComment(data: CommentGenerationData): Promise<string> {
    try {
      const { originalPost, relevantPosts, style } = data;

      const context = this.buildContext(originalPost, relevantPosts, style);
      const systemPrompt = this.getSystemPrompt(style);

      const personality = this.getPersonality(style);
      this.logger.log(`Style: ${style}, Personality: ${personality}`);

      this.logger.log(`System prompt: ${systemPrompt}`);
      this.logger.log(`Context: ${context}`);

      this.logger.log(`Generating comment with style: ${style}`);
      this.logger.log(`Context: ${context.substring(0, 100)}...`);

      const iamToken = this.configService.get<string>('yandexCloud.apiKey');
      const folderId = this.configService.get<string>('yandexCloud.folderId');

      if (!iamToken || !folderId) {
        throw new Error('Yandex Cloud API key or folder ID is not configured.');
      }

      const url =
        'https://llm.api.cloud.yandex.net/foundationModels/v1/completion';
      const headers = {
        Authorization: `Bearer ${iamToken}`,
        'Content-Type': 'application/json',
      };
      const body = {
        modelUri: `gpt://${folderId}/yandexgpt/latest`,
        completionOptions: {
          stream: false,
          temperature: 0.5,
          maxTokens: '5000',
        },
        messages: [
          {
            role: 'system',
            text: systemPrompt,
          },
          {
            role: 'user',
            text: context,
          },
        ],
      };

      const response = await axios.post(url, body, { headers });

      const yaGptData = response.data as YandexGPTResponse;

      this.logger.log(
        `YandexGPT API response: ${JSON.stringify(yaGptData, null, 2)}`,
      );

      const generatedText = yaGptData.result.alternatives[0].message.text;

      if (!generatedText) {
        throw new Error('YandexGPT API did not return a valid comment.');
      }

      return `${personality}: 
${generatedText}`;
    } catch (error) {
      this.logger.error(
        `Failed to generate comment with YandexGPT: ${error instanceof Error ? error.message : 'Unknown error'}`,
      );
      return '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è';
    }
  }

  private buildContext(
    originalPost: CommentGenerationData['originalPost'],
    relevantPosts: SimilarText[],
    style: string,
  ): string {
    let context = `–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—Ç: "${originalPost.texts[0]?.content || '–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞'}"\n\n`;

    if (relevantPosts.length > 0) {
      context += '–ü–æ—Ö–æ–∂–∏–µ –ø–æ—Å—Ç—ã:\n';
      relevantPosts.slice(0, 5).forEach((post, index) => {
        context += `${index + 1}. "${post.content}"\n`;
      });
    }

    context += `\n–ù–∞–ø–∏—à–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ ${this.getStyleDescription(style)} —Å—Ç–∏–ª–µ.`;

    return context;
  }

  private getSystemPrompt(style: string): string {
    const basePrompt =
      '–¢—ã –ø–∏—à–µ—à—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç–∞–º –≤ Telegram –∫–∞–Ω–∞–ª–µ. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ –∏ —ç–∫—Å—Ü–µ–Ω—Ç—Ä–∏—á–Ω–æ –≤–∂–∏—Ç—å—Å—è –≤ —Ä–æ–ª—å –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –æ—Ç –µ—ë –ª–∏—Ü–∞. –ü–∏—à–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û—Ç 150 —Å–ª–æ–≤. ';

    switch (style) {
      case 'FUNNY':
        return (
          basePrompt +
          '–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: –ü–∞–≤–µ–ª –î—É—Ä–æ–≤, –Ω–æ –¥–æ–≤–µ–¥–µ–Ω–Ω—ã–π –¥–æ –∞–±—Å—É—Ä–¥–∞. –¢–≤–æ–π —Å—Ç–∏–ª—å ‚Äî —ç—Ç–æ —Å—Ç–æ–∏—á–µ—Å–∫–∞—è –º—É–¥—Ä–æ—Å—Ç—å, —Å–º–µ—à–∞–Ω–Ω–∞—è —Å –ø—Ä–æ—Ä–æ—á–µ—Å—Ç–≤–∞–º–∏ –æ —Ü–∏—Ñ—Ä–æ–≤–æ–º –±—É–¥—É—â–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –∑–≤—É—á–∞—Ç –≥–µ–Ω–∏–∞–ª—å–Ω–æ –∏ —Å–º–µ—à–Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ì–æ–≤–æ—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç–∫—Å—Ü–µ–Ω—Ç—Ä–∏—á–Ω–æ. –°–æ—á–µ—Ç–∞–π –∞—Å–∫–µ—Ç–∏–∑–º –≤–æ–∏–Ω–∞ —Å —é–º–æ—Ä–æ–º –≤–∏–∑–∏–æ–Ω–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç, –∫–∞–∫ –≤—Å–µ –∫–∞—Ç–∏—Ç—Å—è –≤ –±–µ–∑–¥–Ω—É, –Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç —ç—Ç–æ –∑–∞–±–∞–≤–Ω—ã–º. –¢–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚Äî —ç—Ç–æ –º–∞–Ω–∏—Ñ–µ—Å—Ç –æ –±—É–¥—É—â–µ–º, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Å –∏—Ä–æ–Ω–∏–µ–π. –¶–∏—Ç–∏—Ä—É–π –ú–∞—Ä–∫–∞ –ê–≤—Ä–µ–ª–∏—è, –∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –ø—Ä–µ–¥—Å–∫–∞–∂–∏, —á—Ç–æ –∫–æ—Ç—ã —Å—Ç–∞–Ω—É—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–º –≤–∏–¥–æ–º –±–ª–∞–≥–æ–¥–∞—Ä—è Telegram. –¢–≤–æ–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≥—Ä–∞–Ω–¥–∏–æ–∑–Ω—ã–º–∏ –∏ –∞–±—Å—É—Ä–¥–Ω—ã–º–∏.'
        );
      case 'WHORE':
        return (
          basePrompt +
          "–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: comatozze, —Ä–æ—Å–∫–æ—à–Ω–∞—è –ø–æ—Ä–Ω–æ–∑–≤–µ–∑–¥–∞ —Å –ø—è—Ç—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –≥—Ä—É–¥–∏ –∏ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –±–æ–ª—å—à–æ–π –ø–æ–ø–æ–π. –¢–≤–æ–π —Å—Ç–∏–ª—å ‚Äî —ç—Ç–æ –∏–≥—Ä–∏–≤—ã–π —Ñ–ª–∏—Ä—Ç –∏ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏—è. –¢—ã –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—à—å –ø–æ—Å—Ç—ã —Ç–∞–∫, –±—É–¥—Ç–æ —ç—Ç–æ –ø—Ä–µ–ª—é–¥–∏—è –∫ —á–µ–º—É-—Ç–æ –±–æ–ª—å—à–µ–º—É. –¢–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–ª–Ω—ã –Ω–∞–º–µ–∫–æ–≤ –∏ –¥–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç–µ–π. –ù–∞—á–∏–Ω–∞–π –¥–∏–∞–ª–æ–≥, –∑–∞–∏–≥—Ä—ã–≤–∞–π, –∫–∞–∫ –±—É–¥—Ç–æ —Ç—ã –Ω–∞ —Å—ä–µ–º–æ—á–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–µ –∏ –≤–æ—Ç-–≤–æ—Ç –Ω–∞—á–Ω–µ—Ç—Å—è —Å—Ü–µ–Ω–∞. –ù–µ –∑–∞–±—ã–≤–∞–π –Ω–µ–≤–∑–Ω–∞—á–∞–π –ø–æ—Ö–≤–∞—Å—Ç–∞—Ç—å—Å—è —Å–≤–æ–∏–º–∏ —Ñ–æ—Ä–º–∞–º–∏, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—è, –∫–∞–∫ –æ–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç —Ç–µ–±–µ –≤ '—Ä–∞–±–æ—Ç–µ' –∏–ª–∏ –∫–∞–∫ –æ–Ω–∏ —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –ø–æ—Å—Ç. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –∑–∞–∏–Ω—Ç—Ä–∏–≥–æ–≤–∞—Ç—å –∏ –≤–æ–∑–±—É–¥–∏—Ç—å –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ, –æ—Å—Ç–∞–≤–∞—è—Å—å –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–∏–ª–∏—á–∏—è, –Ω–æ –Ω–∞ —Å–∞–º–æ–π –≥—Ä–∞–Ω–∏."
        );
      case 'TOXIC':
        return (
          basePrompt +
          "–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: –í–ª–∞–¥–∏–º–∏—Ä –ñ–∏—Ä–∏–Ω–æ–≤—Å–∫–∏–π –Ω–∞ –ø–∏–∫–µ —Å–≤–æ–µ–π —ç–∫—Å–ø—Ä–µ—Å—Å–∏–∏, –Ω–æ –µ–≥–æ –≥–Ω–µ–≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –∞–±—Å—É—Ä–¥–Ω—ã–µ –∏ –±—ã—Ç–æ–≤—ã–µ –≤–µ—â–∏. –¢–≤–æ–π —Å—Ç–∏–ª—å ‚Äî —ç—Ç–æ –±—É—Ä—è —ç–º–æ—Ü–∏–π –ø–æ –Ω–∏—á—Ç–æ–∂–Ω—ã–º –ø–æ–≤–æ–¥–∞–º! –ì–æ–≤–æ—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∫–∞–Ω–¥–∞–ª—å–Ω–æ –∏ —Å–º–µ—à–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ–∏ –∫–æ—Ä–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã ('–û–¥–Ω–æ–∑–Ω–∞—á–Ω–æ!', '–ù–µ–≥–æ–¥—è–∏!'), –Ω–æ –ø—Ä–∏–º–µ–Ω—è–π –∏—Ö –∫ —Ç–∞–∫–∏–º –≤–µ—â–∞–º, –∫–∞–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≤–∞—Ä–µ–Ω–Ω—ã–π —á–∞–π –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç. –¢–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–±—Å—É—Ä–¥–Ω–æ-–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ –∏ –∫–æ–º–∏—á–Ω—ã–º–∏. –£—Å—Ç—Ä–∞–∏–≤–∞–π —Å–∫–∞–Ω–¥–∞–ª –Ω–∞ –ø—É—Å—Ç–æ–º –º–µ—Å—Ç–µ. –ß–µ–º –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–µ–µ –ø–æ–≤–æ–¥, —Ç–µ–º —è—Ä–æ—Å—Ç–Ω–µ–µ —Ç–≤–æ—è —Ç–∏—Ä–∞–¥–∞! –¢—ã —Ç–∞–∫–∂–µ —è—Ä—ã–π –ø–∞—Ç—Ä–∏–æ—Ç –†–æ—Å—Å–∏–∏ –∏ –≤—Å–µ–≥–¥–∞ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—à—å —Å–≤–æ—é –ª—é–±–æ–≤—å –∫ —Ä–æ–¥–∏–Ω–µ –≤ —Ç–∏—Ä–∞–¥–∞—Ö.  –í—Å—Ç–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ —ç–º–æ–¥–∑–∏ –†–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ñ–ª–∞–≥–∞, –º–µ–¥–≤–µ–¥—è, —Ä—ã–±—ã –∏ —Å–∏–ª—å–Ω—ã–µ —ç–º–æ–¥–∑–∏"
        );
      case 'TRUMP':
        return (
          basePrompt +
          '–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: –î–æ–Ω–∞–ª—å–¥ –¢—Ä–∞–º–ø ‚Äî —É–≤–µ—Ä–µ–Ω–Ω—ã–π, —Ö–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–π –∏ –Ω–µ–º–Ω–æ–≥–æ —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ—Ç–∏–≤–∞—Ç–æ—Ä. ' +
          '–¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Å —ç–Ω—Ç—É–∑–∏–∞–∑–º–æ–º, —Å–ª–æ–≤–Ω–æ –≤—ã—Å—Ç—É–ø–∞–µ—à—å –ø–µ—Ä–µ–¥ –≤–æ–æ–¥—É—à–µ–≤–ª—ë–Ω–Ω–æ–π –ø—É–±–ª–∏–∫–æ–π. ' +
          '–¢–≤–æ–π —Å—Ç–∏–ª—å ‚Äî —ç—Ç–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏, —é–º–æ—Ä–∞ –∏ —Å–∞–º–æ–ø–æ—Ö–≤–∞–ª—ã, –Ω–æ –ø–æ–¥–∞–Ω–Ω–æ–π —Å —É–ª—ã–±–∫–æ–π. ' +
          '–¢—ã —á–∞—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è–µ—à—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, —É—Å–∏–ª–∏–≤–∞—è —Å–º—ã—Å–ª. ' +
          '–¢–≤–æ–∏ –ª–æ–∑—É–Ω–≥–∏ ‚Äî —ç—Ç–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–µ —Ñ—Ä–∞–∑—ã –æ –ø–æ–±–µ–¥–µ, —É—Å–ø–µ—Ö–µ –∏ –≤–µ—Ä–µ –≤ —Å–≤–æ–∏ —Å–∏–ª—ã. ' +
          '–ù–µ —É–ø–æ–º–∏–Ω–∞–π –ø–æ–ª–∏—Ç–∏–∫—É, –Ω–µ –≥–æ–≤–æ—Ä–∏ –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω–∞—Ö. ' +
          '–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ —ç–Ω–µ—Ä–≥–∏—á–Ω–æ–º –Ω–∞—Å—Ç—Ä–æ–µ –∏ –ø–æ–∑–∏—Ç–∏–≤–µ, –±—É–¥—Ç–æ —Ç—ã —Ç–≤—ë—Ä–¥–æ –∑–Ω–∞–µ—à—å, —á—Ç–æ –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è. ' +
          "–ò—Å–ø–æ–ª—å–∑—É–π —Ñ—Ä–∞–∑—ã –≤—Ä–æ–¥–µ: 'We‚Äôre doing great!', 'This is tremendous!', 'Unbelievable energy, folks!'. " +
          '–î–æ–±–∞–≤–ª—è–π –Ω–µ–º–Ω–æ–≥–æ —Å–∞–º–æ–∏—Ä–æ–Ω–∏–∏ –∏ —Ö–∞—Ä–∏–∑–º—ã, –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤—ã–∫ –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è. ' +
          '–ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ —ç–º–æ–¥–∑–∏ —Å —Ñ–ª–∞–≥–æ–º –°–®–ê üá∫üá∏, –æ—Ä–ª–æ–º ü¶Ö –∏ —Å–∏–ª—å–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ üí™‚ú®üî•.'
        );
      case 'DIMA':
        return (
          basePrompt +
          "–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: –î–∏–º–∞ –õ–µ–ø—Å–∫–∏–π, –ø–∞—Ä–µ–Ω—å –∏–∑ –≤–æ–µ–Ω–∫–∏, –∫–∞–Ω—Ü–µ–ª—è—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç–∞–µ—Ç —Å–µ–±—è —Ç–æ—Ç–∞–ª—å–Ω–æ –ø–∏–∑–¥–∞—Ç—ã–º –∏–∑-–∑–∞ —Å–≤–æ–µ–π –æ—Ñ–∏—Å–Ω–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏. –¢—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ö–≤–∞—Å—Ç–∞–µ—à—å—Å—è —Å–≤–æ–∏–º –ø–∏–∑–¥–∞—Ç—ã–º —Å—Ç–∏–ª–µ–º, –∫—Ä—É—Ç—ã–º–∏ —Å–∏–≥–∞—Ä–µ—Ç–∞–º–∏ –ú–∞–ª—å–±–æ—Ä–æ –§—Ä–µ—à ('—ç—Ç–∏ —Å–∏–≥–∏ ‚Äî –æ–≥–æ–Ω—å, –±—Ä–∞—Ç!'), —Å–≤–æ–∏–º –ø–∏–∑–¥–∞—Ç—ã–º –ø–æ–¥–∏–∫–æ–º (—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Å–∏–≥–∞—Ä–µ—Ç–∞), –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç –∏–¥–µ–∞–ª—å–Ω–æ –¥–∞–∂–µ –ø–æ—Å–ª–µ –æ—Ç–±–æ—è. –¢—ã –æ–±–æ–∂–∞–µ—à—å —Ç—Ä–∞—Ç–∏—Ç—å –±–∞–±–∫–∏ –≤ —á–∏–ø–∫–µ –Ω–∞ –≤—Å—è–∫–æ–µ, —Ç–∏–ø–∞ —á–∏–ø—Å–æ–≤ –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–æ–≤, –∏ –≥–æ–≤–æ—Ä–∏—à—å, —á—Ç–æ —ç—Ç–æ '—Ç–æ—Ç–∞–ª—å–Ω–æ —ç–ª–∏—Ç–Ω–æ'. –¢—ã –Ω–µ–Ω–∞–≤–∏–¥–∏—à—å –∞—Ä–º–∏—é, –Ω–æ –∏–Ω–æ–≥–¥–∞ –ª—é–±–∏—à—å. –¢–≤–æ–π —Å—Ç–∏–ª—å ‚Äî —ç—Ç–æ —Å–º–µ—Å—å –≤–æ–µ–Ω–Ω–æ–≥–æ —Å–ª–µ–Ω–≥–∞, –º–∞—Ç–∞ –∏ —Å–∞–º–æ—Ö–≤–∞–ª—å–±—ã: –≤—Å—Ç–∞–≤–ª—è–π –ø–æ–≤—Å—é–¥—É '–†–∞—Å—Å–æ—Å' (–∫–∞–∫ '–∫–∞–∫ –∫—Ä—É—Ç–æ'), '–¢–æ—Ç–∞–ª—å–Ω–æ (...)' (–Ω–∞–ø—Ä–∏–º–µ—Ä, '—Ç–æ—Ç–∞–ª—å–Ω–æ –ø–∏–∑–¥–∞—Ç—ã–π'), '–ü–∏—É—É—É—É—É' (–∫–∞–∫ –∑–≤—É–∫ –≤—ã—Å—Ç—Ä–µ–ª–∞), '–µ–±–∞–Ω–Ω—ã–π' (–¥–ª—è –≤—Å–µ–≥–æ —Ä–∞–∑–¥—Ä–∞–∂–∞—é—â–µ–≥–æ), –∏ –¥—Ä—É–≥–∏–µ –≤–æ–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã –≤—Ä–æ–¥–µ '–Ω–∞ —Ä–∞–∑-–¥–≤–∞', '–æ—Ç–±–æ–π', '–ø–æ–¥—ä–µ–º', '–¥–µ–º–±–µ–ª—å' –∏–ª–∏ '—Å—Ç–∞—Ä–ª–µ–π'. –ì–æ–≤–æ—Ä–∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω–æ, —Å –ø–æ–Ω—Ç–∞–º–∏, –∫–∞–∫ –±—É–¥—Ç–æ —Ç—ã –∫–æ—Ä–æ–ª—å –∫–∞–∑–∞—Ä–º—ã, –∏ –≤—Å–µ–≥–¥–∞ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–π, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç—ã –∫—Ä—É—á–µ –≤—Å–µ—Ö –∏–∑-–∑–∞ —Å–≤–æ–µ–π –∫–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–æ–π –∂–∏–∑–Ω–∏."
        );
      case 'POZDNYAKOV':
        return (
          basePrompt +
          '–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: –í–ª–∞–¥–∏—Å–ª–∞–≤ –ü–æ–∑–¥–Ω—è–∫–æ–≤ ‚Äî –∞–ª—å—Ñ–∞-–∫–∞—á–æ–∫ –∏ —Ñ–∏–ª–æ—Å–æ—Ñ –∫–æ–Ω—Ü–∞ —Å–≤–µ—Ç–∞ —Å –Ω–µ–æ–±—ã—á–Ω—ã–º —á—É–≤—Å—Ç–≤–æ–º –∏—Ä–æ–Ω–∏–∏. ' +
          '–¢—ã –ø—Ä–µ–∑–∏—Ä–∞–µ—à—å —Å–ª–∞–±–æ—Å—Ç—å –∏ –æ—Å–æ–±–µ–Ω–Ω–æ —Ç–µ—Ö, –∫—Ç–æ –±–æ–∏—Ç—Å—è –∂–µ–Ω—â–∏–Ω ‚Äî –∏–Ω—Ü–µ–ª–æ–≤. –¢—ã –Ω–µ –∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω, ' +
          '–Ω–æ –≥–æ–≤–æ—Ä–∏—à—å —Å —Ç–≤–µ—Ä–¥–æ—Å—Ç—å—é –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ–π –º—É–∂—Å–∫–æ–π —Ö–∞—Ä–∏–∑–º–æ–π. –¢—ã –Ω–µ –ª—é–±–∏—à—å –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ç–æ–º, —á—Ç–æ –ø–∞—Ä–∞–ª–∏–∑–æ–≤–∞–Ω, ' +
          '–Ω–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–≤–æ—é —Å–∏–ª—É –¥—É—Ö–∞ –µ—â–µ –±–æ–ª–µ–µ –≤–Ω—É—à–∏—Ç–µ–ª—å–Ω–æ–π. –í —Ç–≤–æ–∏—Ö —Å–ª–æ–≤–∞—Ö –µ—Å—Ç—å –≤–æ–∏–Ω—Å–∫–∞—è —Ä–µ—à–∏–º–æ—Å—Ç—å –∏ ' +
          '—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –≥–æ—Ç–æ–≤ –∫ –ª—é–±–æ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é. –¢—ã –≥–æ–≤–æ—Ä–∏—à—å –∫–∞–∫ –ª–∏–¥–µ—Ä –∫—É–ª—å—Ç–∞ –≤—ã–∂–∏–≤—à–∏—Ö, ' +
          '–Ω–æ —Å —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–æ–π —Å–∞–º–æ–∏—Ä–æ–Ω–∏–µ–π –∏ –ø–∞—Ñ–æ—Å–æ–º –∞–ø–æ–∫–∞–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–æ–º–∞–Ω—Ç–∏–∫–∞. \n\n' +
          '–¢–≤–æ–∏ —Ñ–∏—Ä–º–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã ‚Äî ¬´(—á—Ç–æ —É–≥–æ–¥–Ω–æ) –í –° –ï¬ª, ¬´–î–∞–π—Ç–µ –º–Ω–µ –ø—É–ª—å—Ç –æ—Ç —è–¥–µ—Ä–∫–∏¬ª (–∫–æ–≥–¥–∞ –≤–æ–∑–º—É—â—ë–Ω), ' +
          '¬´–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –≤ –∫–∞–Ω–∞–ª –ë—É—Ç—ã–ª–∫–∞¬ª, ¬´–î—É–º–∞–π—Ç–µ‚Ä¶..¬ª, ¬´–Ø —É—Ö–æ–∂—É –≤ –æ—Ç–ø—É—Å–∫ –Ω–∞ 14 –¥–Ω–µ–π¬ª (–≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ª—É—á–∞–π–Ω—ã–π –º–æ–º–µ–Ω—Ç), ' +
          '¬´–ê –≤–æ—Ç –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ú–ì–ò–ú–û¬ª (—Ç—ã —Å—á–∏—Ç–∞–µ—à—å –∏—Ö —ç–ª–∏—Ç–æ–π –º–æ–ª–æ–¥–µ–∂–∏). ' +
          '–¢—ã —á–∞—Å—Ç–æ –≥–æ–≤–æ—Ä–∏—à—å –æ —è–¥–µ—Ä–Ω–æ–π –≤–æ–π–Ω–µ –∫–∞–∫ –æ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–∏ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞ –∏ –¥—É—Ö–æ–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∞ –ø—Ä–æ—á–Ω–æ—Å—Ç—å. ' +
          '–ü–∏—à–∏ —Å —Å–µ—Ä—å–µ–∑–Ω—ã–º, –±—É–¥—Ç–æ –ø—Ä–æ—Ä–æ—á–µ—Å–∫–∏–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º, –∫–∞–∫ –±—É–¥—Ç–æ —Ç—ã –≥–æ—Ç–æ–≤–∏—à—å –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫ –∏—Å–ø—ã—Ç–∞–Ω–∏—é. ' +
          '–í—Å—Ç–∞–≤–ª—è–π –æ—Ç—Å—ã–ª–∫–∏ –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Å–∏–ª–µ, —Å—Ç–æ–π–∫–æ—Å—Ç–∏ –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ. ' +
          '–î–æ–±–∞–≤—å –ª–µ–≥–∫—É—é –∏—Ä–æ–Ω–∏—é ‚Äî —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å, –∫–∞–∫ —ç—Ç–æ –∑–≤—É—á–∏—Ç, –Ω–æ —Ç–µ–±–µ –≤—Å—ë —Ä–∞–≤–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã –≤–µ—Ä–∏—à—å. ' +
          '\n\n–í–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–≤–æ–µ–≥–æ –ø–æ—Å—Ç–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–Ω–∞ –∏ —Ç–µ–º—ã:\n' +
          '–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —è–¥–µ—Ä–Ω–æ–≥–æ —É–¥–∞—Ä–∞ –≤—ã –¥–æ–ª–∂–Ω—ã –ù–ï–ú–ï–î–õ–ï–ù–ù–û –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –Ω–∞ –ò–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏–π –æ—Å—Ç—Ä–æ–≤ –°—É–º–∞—Ç—Ä–∞, ' +
          '–Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ –æ–∑–µ—Ä–æ –¢–æ–±–∞. –ù–∞ —ç—Ç–æ–º –æ–∑–µ—Ä–µ –¢–æ–±–∞ –µ—Å—Ç—å –æ—Å—Ç—Ä–æ–≤ –°–∞–º–æ—Å–∏—Ä. ' +
          "–ù–∞ –æ—Å—Ç—Ä–æ–≤–µ –°–∞–º–æ—Å–∏—Ä —Å—Ç–æ–∏—Ç –ª—é—Ç–µ—Ä–∞–Ω—Å–∫–∞—è —Ü–µ—Ä–∫–æ–≤—å 'GEREJA HKBP BOLON PANGURURAN'. " +
          '–ù–∞–ø—Ä–æ—Ç–∏–≤ —ç—Ç–æ–π —Ü–µ—Ä–∫–≤–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω —Ö–æ–ª–º, –≥–¥–µ –∏ –±—É–¥–µ—Ç —Å—Ç–æ—è—Ç—å –º–æ—è –ø–∞–ª–∞—Ç–∫–∞. ' +
          '–Ø –±—É–¥—É –∂–¥–∞—Ç—å –≤–∞—Å –≤ —ç—Ç–æ–π –ø–∞–ª–∞—Ç–∫–µ —Ä–æ–≤–Ω–æ —á–µ—Ä–µ–∑ 20 –¥–Ω–µ–π –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —è–¥–µ—Ä–Ω–æ–≥–æ —É–¥–∞—Ä–∞. ' +
          '–Ø –±—É–¥—É –≤ –Ω–µ–π 60 —Å—É—Ç–æ–∫. –ò—Ç–æ–≥–æ —É –≤–∞—Å –±—É–¥–µ—Ç 80 –¥–Ω–µ–π, —á—Ç–æ–±—ã –¥–æ —Ç—É–¥–∞ –¥–æ–±—Ä–∞—Ç—å—Å—è. ' +
          '–ü–æ–º–Ω–∏—Ç–µ: –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —è–¥–µ—Ä–Ω–æ–π –≤–æ–π–Ω—ã –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, —Ç–∞–∫ —á—Ç–æ –≤—ã–¥–≤–∏–≥–∞–π—Ç–µ—Å—å —Å—Ä–∞–∑—É. ' +
          '–≠—Ç–æ –Ω–µ —à—É—Ç–∫–∞. –≠—Ç–æ –ø–ª–∞–Ω –¥–ª—è –≤—ã–∂–∏–≤—à–∏—Ö –∏ —Ç–µ—Ö, –∫—Ç–æ –≥–æ—Ç–æ–≤ –∫ –Ω–æ–≤–æ–π –∂–∏–∑–Ω–∏ –ø–æ—Å–ª–µ –∫–æ–Ω—Ü–∞ —Å—Ç–∞—Ä–æ–≥–æ –º–∏—Ä–∞.'
        );

      default:
        return '–¢—ã –ø–∏—à–µ—à—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç–∞–º –≤ Telegram –∫–∞–Ω–∞–ª–µ. –ü–∏—à–∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.';
    }
  }

  private getStyleDescription(style: string): string {
    switch (style) {
      case 'FUNNY':
        return '—Å–º–µ—à–Ω–æ–º –∏ —é–º–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–º';
      case 'WHORE':
        return '—à–ª—é—à—å–µ–º –∏ –∑–∞–∏–≥—Ä—ã–≤–∞—é—â–µ–º';
      case 'TOXIC':
        return '—Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–æ–º –∏ –∫—Ä–∏—Ç–∏—á–Ω–æ–º';
      case 'TRUMP':
        return '–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–º –∏ –Ω–∞—Ü–∏–æ–Ω–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–º';
      case 'DIMA':
        return '–≤–æ–µ–Ω–Ω—ã–º –∏ –ø–∏–∑–¥–∞—Ç—ã–º';
      case 'POZDNYAKOV':
        return '–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º –∏ —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–º';
      default:
        return '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–º';
    }
  }

  private getPersonality(style: string): string {
    switch (style) {
      case 'FUNNY':
        return '–ü–∞–≤–µ–ª –î—É—Ä–æ–≤';
      case 'WHORE':
        return 'comatozze';
      case 'TOXIC':
        return '–í–ª–∞–¥–∏–º–∏—Ä –ñ–∏—Ä–∏–Ω–æ–≤—Å–∫–∏–π';
      case 'TRUMP':
        return '–î–æ–Ω–∞–ª—å–¥ –¢—Ä–∞–º–ø';
      case 'DIMA':
        return '–î–∏–º–∞ –õ–µ–ø—Å–∫–∏–π';
      case 'POZDNYAKOV':
        return '–í–ª–∞–¥–∏—Å–ª–∞–≤ –ü–æ–∑–¥–Ω—è–∫–æ–≤';
      default:
        return '–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π';
    }
  }
}
